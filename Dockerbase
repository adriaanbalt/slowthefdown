FROM debian:8.3
MAINTAINER Adriaan Balt Louis Scholvinck <adriaan@balt.us>
ENV NODE_VERSION=4.3.1 \
    NPM_VERSION=3.7.3

RUN ln -snf /bin/bash /bin/sh; \
    apt-get update && apt-get install -y --no-install-recommends \
      curl \
      git \
      ca-certificates \
      libpng12-dev \
      pngquant \
      ruby-compass; \
    curl https://raw.githubusercontent.com/creationix/nvm/master/install.sh | sh; \
    cp -f ~/.nvm/nvm.sh ~/.nvm/nvm-tmp.sh; \
    echo "nvm install ${NODE_VERSION}; nvm alias default ${NODE_VERSION}; ln -s ~/.nvm/versions/node/v${NODE_VERSION}/bin/node /usr/bin/node; ln -s ~/.nvm/versions/node/v${NODE_VERSION}/bin/npm /usr/bin/npm" >> ~/.nvm/nvm-tmp.sh; \
    sh ~/.nvm/nvm-tmp.sh; \
    rm ~/.nvm/nvm-tmp.sh; \
    npm config set registry https://registry.npmjs.org/; \
    npm install -g npm@${NPM_VERSION}; \
    npm set progress=false

CMD ["/bin/bash"]